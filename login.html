<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Sphere UI</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Consolas", monospace;
        }

        body {
            background: #0d0d0e;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
        }

        #neuralCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        /* Caixa de Login */
        .login-box {
            width: 330px;
            padding: 32px;
            background: rgba(0, 0, 0, 0.45);
            backdrop-filter: blur(12px);
            border-radius: 14px;
            border: 1px solid #00ffcc55;
            box-shadow: 0 0 25px #00ffcc55;
        }

        .login-box h2 {
            text-align: center;
            margin-bottom: 22px;
            letter-spacing: 2px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            margin-top: 6px;
            border: 1px solid #00ffcc;
            background: transparent;
            color: #00ffcc;
            border-radius: 8px;
            outline: none;
        }

        .btn {
            width: 100%;
            padding: 12px;
            font-size: 1.1rem;
            margin-top: 10px;
            background: #00ffcc22;
            border: 1px solid #00ffcc;
            color: #00ffcc;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.25s;
        }

        .btn:hover {
            background: #00ffcc55;
        }
    </style>
</head>

<body>

    <canvas id="neuralCanvas"></canvas>

    <div class="login-box">
        <h2>ACESSO</h2>

        <div class="input-group">
            <label>Usuário</label>
            <input type="text" id="username" placeholder="root">
        </div>

        <div class="input-group">
            <label>Senha</label>
            <input type="password" id="password" placeholder="••••••••">
        </div>

        <button class="btn" id="loginBtn">Entrar</button>
    </div>

    <script>
        <!-- Configurações do Supabase -->
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js?v=1.3"></script>

    <script>
        // === LOGICA DE LOGIN (REAL SUPABASE) =======================================
        document.getElementById('loginBtn').addEventListener('click', async function () {
            const loginBtn = document.getElementById('loginBtn');
        const originalText = loginBtn.innerText;

        // UI Feedback
        loginBtn.innerText = "Verificando...";
        loginBtn.style.opacity = "0.7";
        loginBtn.disabled = true;

        const email = document.getElementById('username').value.trim(); // User field is now Email
        const password = document.getElementById('password').value.trim();

        try {
                if (!supabase) {
                    throw new Error("Erro de conexão com o sistema (Supabase não carregou).");
                }

        // Attempt Login
        const {data, error} = await supabase.auth.signInWithPassword({
            email: email,
        password: password
                });

        if (error) {
            console.error("Login Error:", error);
        throw new Error("Email ou senha incorretos.");
                }

        if (data.session) {
            console.log("Login successful:", data.user.email);

        // Set Access Flags
        sessionStorage.setItem('zenox_access_granted', 'true');
        localStorage.setItem('zenox_access_granted', 'true');

        // Redirect
        window.location.href = 'index.html';
                }

            } catch (err) {
            alert(err.message);
        // Visual Error Effect
        document.querySelector('.login-box').style.borderColor = '#ff3333';
                setTimeout(() => {
            document.querySelector('.login-box').style.borderColor = '#00ffcc55';
                }, 1000);
            } finally {
            // Reset UI
            loginBtn.innerText = originalText;
        loginBtn.style.opacity = "1";
        loginBtn.disabled = false;
            }
        });

        // Permitir Enter para login
        document.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
            document.getElementById('loginBtn').click();
            }
        });

        // === CONFIGURAÇÃO DO CANVAS ================================================

        const canvas = document.getElementById("neuralCanvas");
        const ctx = canvas.getContext("2d");

        function resize() {
            canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        }
        resize();
        window.addEventListener("resize", resize);

        // ==========================================================================
        // CRIAÇÃO DOS NÓS
        // ==========================================================================

        const TOTAL_NODES = 420;
        const nodes = [];

        // Paleta neon para clusters (igual imagem)
        const COLORS = [
        "#00ff99", "#00ccff", "#ff00ff",
        "#ffaa00", "#ff3333", "#66ff66",
        "#9999ff"
        ];

        function randomColor() {
            return COLORS[Math.floor(Math.random() * COLORS.length)];
        }

        // Esfera grande e fixa (sem pulsar)
        for (let i = 0; i < TOTAL_NODES; i++) {

            const angle = Math.random() * Math.PI * 2;
        const baseRadius = canvas.height * 0.42;
        const offset = Math.random() * (canvas.height * 0.10);
        const radius = baseRadius - offset;

        const x = canvas.width / 2 + Math.cos(angle) * radius;
        const y = canvas.height / 2 + Math.sin(angle) * radius;

        nodes.push({
            x,
            y,
            vx: (Math.random() - 0.5) * 0.40,
        vy: (Math.random() - 0.5) * 0.40,
        color: randomColor(),
        size: Math.random() * 2 + 1.5
            });
        }

        // ==========================================================================
        // ANIMAÇÃO
        // ==========================================================================

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Ligações entre nós
        for (let i = 0; i < TOTAL_NODES; i++) {
                for (let j = i + 1; j < TOTAL_NODES; j++) {

                    const a = nodes[i];
        const b = nodes[j];

        const dx = a.x - b.x;
        const dy = a.y - b.y;

        const dist = Math.sqrt(dx * dx + dy * dy);

        if (dist < 150) {
                        const alpha = 1 - dist / 150;

        ctx.strokeStyle = `rgba(0,255,180,${alpha * 0.45})`;
        ctx.lineWidth = alpha;
        ctx.beginPath();
        ctx.moveTo(a.x, a.y);
        ctx.lineTo(b.x, b.y);
        ctx.stroke();
                    }
                }
            }

        // Movimento leve sem pulsação
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const maxRadius = canvas.height * 0.45;

        for (let n of nodes) {

            n.x += n.vx;
        n.y += n.vy;

        // Mantém dentro da esfera sem puxar para o centro
        const dx = n.x - centerX;
        const dy = n.y - centerY;

        const dist = Math.sqrt(dx * dx + dy * dy);

                if (dist > maxRadius) {
            n.vx *= -1;
        n.vy *= -1;
                }

        ctx.fillStyle = n.color;
        ctx.beginPath();
        ctx.arc(n.x, n.y, n.size, 0, Math.PI * 2);
        ctx.fill();
            }

        requestAnimationFrame(animate);
        }

        animate();
    </script>

</body>

</html>